mysql中大多数的事务型存储引擎都不是简单的行级别锁机制.

而是**使用行级锁和多版本并发控制技术(MVCC)结合使用**

> 可以认为MVCC是行级锁的变种,但MVCC在很多情况下避免了加锁操作
>
> **非阻塞的读操作+仅锁定必要的行**

MVCC工作原理:

使用数据的**某个时间点的快照**来实现

能够保证

1. 无论事务运行多长时间都可以看到一致的视图
2. **不同事务**可以在**同一时间**看到**相同表不同数据**

InnoDB通过在**事务启动时分配一个事务ID**来实现MVCC.

* 该ID在事务**首次读取任何数据**时分配
* 该ID在事务中**修改记录**时,将向**Undo**日志写入**如何恢复该更改**的Undo记录,并且事务的**回滚指针**指向该Undo日志记录(这就是回滚方法)

> MVCC实现了非阻塞的读操作,随之而来的是**存储引擎在每一行中存储更多的数据**,在检查行时需要更多的工作

MVCC适用于REPEATABLE READ和RAED COMMITED



